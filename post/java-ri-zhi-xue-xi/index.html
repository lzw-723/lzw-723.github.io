<html>
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Java日志学习 | lzw-723&#39;s blog</title>
<link rel="shortcut icon" href="https://lzw-723.github.io/favicon.ico?v=1638588582579">
<link href="https://cdn.jsdelivr.net/npm/remixicon@2.3.0/fonts/remixicon.css" rel="stylesheet">
<link rel="stylesheet" href="https://lzw-723.github.io/styles/main.css">
<link rel="alternate" type="application/atom+xml" title="Java日志学习 | lzw-723&#39;s blog - Atom Feed" href="https://lzw-723.github.io/atom.xml">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700">



    <meta name="description" content="不要再滥用System.out.println()了


日志概念
日志是什么

生活中的日志是记录你生活的点点滴滴，让它把你内心的世界表露出来，更好的诠释自己的内心世界，而电脑里的日志可以是有价值的信息宝库，也可以是毫无价值的数据泥潭。
..." />
    <meta name="keywords" content="日志,笔记,Java" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.10.0/katex.min.css">
    <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  </head>
  <body>
    <div class="main">
      <div class="main-content">
        <div class="site-header">
  <a href="https://lzw-723.github.io">
  <img class="avatar" src="https://lzw-723.github.io/images/avatar.png?v=1638588582579" alt="">
  </a>
  <h1 class="site-title">
    lzw-723&#39;s blog
  </h1>
  <p class="site-description">
    要玩就玩得开心，这不代表我放弃
  </p>
  <div class="menu-container">
    
      
        <a href="/" class="menu">
          首页
        </a>
      
    
      
        <a href="/archives" class="menu">
          归档
        </a>
      
    
      
        <a href="/tags" class="menu">
          标签
        </a>
      
    
      
        <a href="/post/anime" class="menu">
          动画
        </a>
      
    
      
        <a href="/post/friends" class="menu">
          友链
        </a>
      
    
      
        <a href="/post/about" class="menu">
          关于
        </a>
      
    
  </div>
  <div class="social-container">
    
      
        <a href="https://github.com/lzw-723" target="_blank">
          <i class="ri-github-line"></i>
        </a>
      
    
      
    
      
    
      
        <a href="https://www.zhihu.com/people/lzw-723" target="_blank">
          <i class="ri-zhihu-line"></i>
        </a>
      
    
      
    
  </div>
</div>

        <div class="post-detail">
          <article class="post">
            <h2 class="post-title">
              Java日志学习
            </h2>
            <div class="post-info">
              <span>
                2021-07-01
              </span>
              <span>
                9 min read
              </span>
              
                <a href="https://lzw-723.github.io/tag/Jbaals4qL/" class="post-tag">
                  # 日志
                </a>
              
                <a href="https://lzw-723.github.io/tag/ol7l837c1/" class="post-tag">
                  # 笔记
                </a>
              
                <a href="https://lzw-723.github.io/tag/Vnn1O5LMY/" class="post-tag">
                  # Java
                </a>
              
            </div>
            
              <img class="post-feature-image" src="https://z3.ax1x.com/2021/07/01/Rsk2Bn.jpg" alt="">
            
            <div class="post-content-wrapper">
              <div class="post-content">
                <p>不要再滥用<code>System.out.println()</code>了</p>
<!-- more -->
<hr>
<h2 id="日志概念">日志概念</h2>
<h3 id="日志是什么">日志是什么</h3>
<blockquote>
<p>生活中的日志是记录你生活的点点滴滴，让它把你内心的世界表露出来，更好的诠释自己的内心世界，而电脑里的日志可以是有价值的信息宝库，也可以是毫无价值的数据泥潭。</p>
</blockquote>
<p>网络设备、系统及服务程序等，在运作时都会产生一个叫<code>log</code>的事件记录；每一行日志都记载着日期、时间、使用者及动作等相关操作的描述。</p>
<h3 id="日志有什么优点">日志有什么优点</h3>
<p>输出日志，而不是用<code>System.out.println()</code>，有以下几个好处：</p>
<ol>
<li>可以设置输出样式，避免自己每次都写<code>&quot;ERROR: &quot; + var</code>；</li>
<li>可以设置输出级别，禁止某些级别输出。例如，只输出错误日志；</li>
<li>可以被重定向到文件，这样可以在程序运行结束后查看日志；</li>
<li>可以按包名控制日志级别，只输出某些包打的日志；</li>
<li>……</li>
</ol>
<p>总之就是十分友好。</p>
<hr>
<h2 id="java中的日志">Java中的日志</h2>
<h3 id="常见的日志工具">常见的日志工具</h3>
<ul>
<li>[日志实现]<code>Java</code>标准库内置的日志包<code>java.util.logging</code></li>
<li>[<strong>日志接口</strong>][不活跃]<code>Apache</code>软件基金会的<a href="https://commons.apache.org/proper/commons-logging/"><code>Commons Logging</code></a></li>
<li>[<strong>日志接口</strong>][<strong>活跃</strong>]<code>QOS.ch</code>的日志抽象<a href="http://www.slf4j.org/"><code>SLF4J</code></a></li>
<li>[日志实现][不活跃]<code>Apache</code>软件基金会的<a href="https://logging.apache.org/log4j/"><code>log4j</code></a></li>
<li>[日志实现][<strong>活跃</strong>]<code>QOS.ch</code>的<a href="https://logback.qos.ch/"><code>Logback</code></a></li>
</ul>
<h3 id="我的选择">我的选择</h3>
<p>截止当前(<em>2021年7月1日</em>)以上只有<code>SLF4J</code>和<code>Logback</code>近期(<strong>一个月内</strong>)还有<code>commit</code><br>
所以笔者做以下选择</p>
<ul>
<li><code>SLF4J</code> + <code>Logback</code></li>
</ul>
<h3 id="准备工作">准备工作</h3>
<h4 id="新建示例工程">新建示例工程</h4>
<p>笔者选择使用更为简单的<code>Maven</code>工程<br>
目录结构如下（已删去无关文件）</p>
<pre><code class="language-shell">│   pom.xml
│
├───src
    └───main
        └───java
            └───com
                └───example
                        App.java
</code></pre>
<p>唯一源代码文件<code>App.java</code></p>
<pre><code class="language-java">package com.example;

/**
 * Hello world!
 *
 */
public class App
{
    public static void main( String[] args )
    {
        System.out.println( &quot;Hello World!&quot; );
    }
}
</code></pre>
<h3 id="配置工程依赖">配置工程依赖</h3>
<pre><code class="language-xml">  &lt;dependencies&gt;
    &lt;!-- slf4j-api --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-api&lt;/artifactId&gt;
      &lt;version&gt;1.7.31&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- logback --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
      &lt;artifactId&gt;logback-core&lt;/artifactId&gt;
      &lt;version&gt;1.2.3&lt;/version&gt;
    &lt;/dependency&gt;
    &lt;!-- logback-classic（已含有对slf4j的集成包） --&gt;
    &lt;dependency&gt;
      &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt;
      &lt;artifactId&gt;logback-classic&lt;/artifactId&gt;
      &lt;version&gt;1.2.3&lt;/version&gt;
    &lt;/dependency&gt;
  &lt;/dependencies&gt;
</code></pre>
<h2 id="上手">上手</h2>
<h3 id="最基本的用法">最基本的用法</h3>
<pre><code class="language-java">    public static void main(String[] args) {
        System.out.println(&quot;Hello World!&quot;);
        helloSLF4J();
    }

    public static void helloSLF4J() {
        Logger logger = LoggerFactory.getLogger(App.class);
        logger.info(&quot;Hello SLF4J!&quot;);
    }
</code></pre>
<p>控制台输出</p>
<pre><code class="language-shell">Hello World!
16:38:54.863 [main] INFO com.example.App - Hello SLF4J!
</code></pre>
<p>看到没，<code>时间 [线程] 日志等级 所在类 - 信息</code>的友善格式完胜直接<code>System.out.println()</code></p>
<h3 id="slf4j日志等级">SLF4J日志等级</h3>
<p>优先级由低到高：</p>
<ol>
<li>trace - 一般用来追踪详细的程序运行流</li>
<li>debug - 这类日志往往用在调试场景</li>
<li>info - 用来记录程序运行的一些关键信息</li>
<li>warn - 用来记录一些警告信息</li>
<li>error - 用来记录运行时的错误信息</li>
</ol>
<p>代码实例</p>
<pre><code class="language-java">        Logger logger = LoggerFactory.getLogger(App.class);
        logger.trace(&quot;Hello trace!&quot;);
        logger.debug(&quot;Hello debug!&quot;);
        logger.info(&quot;Hello info!&quot;);
        logger.warn(&quot;Hello warn!&quot;);
        logger.error(&quot;Hello error!&quot;);
</code></pre>
<p>控制台输出</p>
<pre><code class="language-shell">16:56:14.662 [main] DEBUG com.example.App - Hello debug!
16:56:14.669 [main] INFO com.example.App - Hello info!
16:56:14.669 [main] WARN com.example.App - Hello warn!
16:56:14.669 [main] ERROR com.example.App - Hello error!
</code></pre>
<p>可以看到除了trace其余等级的日志都打印了出来，为什么trace那么可怜？答案下节揭晓。</p>
<h3 id="配置文件logback">配置文件(Logback)</h3>
<p>SLF4J不过是日志接口而已，要想对日志进行配置，还需要在resources目录下新建一个配置文件。</p>
<pre><code class="language-shell">│   pom.xml
│
├───src
    └───main
        ├───java
        │   └───com
        │       └───example
        │               App.java
        │
        └───resources
                logback.xml
</code></pre>
<p>配置文件格式可以是<code>groovy</code>或<code>xml</code>，笔者不熟悉<code>groovy</code>，所以选择<code>xml</code>格式。</p>
<h4 id="groovy">Groovy</h4>
<p><code>Groovy</code>是一种基于<code>JVM</code> 的敏捷开发语言，它结合了<code>Python</code>、<code>Ruby</code> 和 <code>Smalltalk</code> 的许多强大的特性。既可以作为脚本语言直接解释执行，也可以编译成<code>Java</code>字节码执行，十分强大。<br>
这里不做过多介绍。</p>
<h4 id="xml">XML</h4>
<blockquote>
<p>XML 指可扩展标记语言（e<strong>X</strong>tensible <strong>M</strong>arkup <strong>L</strong>anguage）。<br>
XML 被设计用来传输和存储数据。</p>
</blockquote>
<p><em>logback.xml</em>内容如下</p>
<pre><code class="language-xml">&lt;configuration&gt;

    &lt;appender name=&quot;STDOUT&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;xml %d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;

    &lt;root level=&quot;trace&quot;&gt;
        &lt;appender-ref ref=&quot;STDOUT&quot; /&gt;
    &lt;/root&gt;
&lt;/configuration&gt;
</code></pre>
<h5 id="名词解释">名词解释</h5>
<table>
<thead>
<tr>
<th>名词</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>configuration</td>
<td>配置</td>
</tr>
<tr>
<td>appender</td>
<td>输出源</td>
</tr>
<tr>
<td>encoder</td>
<td>编码器</td>
</tr>
<tr>
<td>pattern</td>
<td>模式</td>
</tr>
<tr>
<td>layout</td>
<td>布局</td>
</tr>
<tr>
<td>root</td>
<td>根</td>
</tr>
</tbody>
</table>
<p>笔者从<code>logback</code>官方手册中复制了一个最简单的配置，但又有所修改。<br>
文件定义了一个名为<code>STDOUT</code>的<code>appender</code>，又它的<code>class</code>属性可以看出，它是一个向控制台输出的<code>appender</code>。<br>
这个<code>appender</code>的<code>encoder</code>的<code>pattern</code>是<code>xml %d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</code>。</p>
<h5 id="conversion-word">Conversion Word</h5>
<blockquote>
<p>像%d{HH:mm:ss.SSS}中的{HH:mm:ss.SSS}是代表时间的格式，{}中的内容是转义词的一些属性。<br>
更详细的解释可以看<a href="https://logback.qos.ch/manual/layouts.html#conversionWord">这里</a></p>
</blockquote>
<p>转义词(<em>Conversion Word</em>)表[部分]</p>
<table>
<thead>
<tr>
<th>名词</th>
<th>意义</th>
</tr>
</thead>
<tbody>
<tr>
<td>%d</td>
<td>当前时间</td>
</tr>
<tr>
<td>%thread</td>
<td>当前线程</td>
</tr>
<tr>
<td>%level</td>
<td>当前消息等级</td>
</tr>
<tr>
<td>%logger</td>
<td>当前logger</td>
</tr>
<tr>
<td>%msg</td>
<td>消息内容</td>
</tr>
<tr>
<td>%n</td>
<td>换行</td>
</tr>
</tbody>
</table>
<p>搞懂了<code>%</code>和<code>{}</code>的意义，但这个<code>%-5level</code>中间夹的<code>-5</code>又是怎么回事？</p>
<h5 id="format-modifiers">Format modifiers</h5>
<blockquote>
<p>用格式修饰符可以美观地对齐内容。<br>
点击<a href="https://logback.qos.ch/manual/layouts.html#formatModifiers">这里</a>看更多用法与详解。</p>
</blockquote>
<p>格式修饰符(<em>Format modifiers</em>)表[部分]</p>
<table>
<thead>
<tr>
<th>格式修饰符</th>
<th>左对齐</th>
<th>最小宽度[字符]</th>
<th>最大宽度[字符]</th>
</tr>
</thead>
<tbody>
<tr>
<td>%20logger</td>
<td>否</td>
<td>20</td>
<td>无</td>
</tr>
<tr>
<td>%-20loggerr</td>
<td>是</td>
<td>20</td>
<td>无</td>
</tr>
<tr>
<td>%.30logger</td>
<td>-</td>
<td>无</td>
<td>30</td>
</tr>
</tbody>
</table>
<p>所以，<code>%-5level</code>就是将等级以最小5个字符左对齐。</p>
<p><code>root</code>是配置的根，它的输出等级是<code>trace</code>，<code>root</code>中引用了名为<code>STDOUT</code>的<code>appender</code>。<br>
让我们再运行一次工程。</p>
<pre><code class="language-shell">xml 17:30:34.232 [main] TRACE com.example.App - Hello trace!
xml 17:30:34.234 [main] DEBUG com.example.App - Hello debug!
xml 17:30:34.235 [main] INFO  com.example.App - Hello info!
xml 17:30:34.235 [main] WARN  com.example.App - Hello warn!
xml 17:30:34.235 [main] ERROR com.example.App - Hello error!
</code></pre>
<p>look!!!<br>
每行日志开头都由我们写进<code>pattern</code>的<strong>xml</strong>开头，我们的<code>xml</code>配置文件生效了。而且这一次，<code>trace</code>级别的日志打印出来了！再也不是没人爱了！</p>
<h4 id="输出日志到文件">输出日志到文件</h4>
<p>新增<code>appender</code></p>
<pre><code class="language-xml">&lt;appender name=&quot;FILE&quot; class=&quot;ch.qos.logback.core.FileAppender&quot;&gt;
        &lt;file&gt;myApp.log&lt;/file&gt;
        &lt;encoder&gt;
            &lt;pattern&gt;file %date %level [%thread] %logger{36} [%file:%line] %msg%n&lt;/pattern&gt;
        &lt;/encoder&gt;
    &lt;/appender&gt;
</code></pre>
<p>别忘了在<code>root</code>中引用</p>
<pre><code class="language-xml">&lt;appender-ref ref=&quot;FILE&quot; /&gt;
</code></pre>
<p>运行代码<br>
发现项目目录下出现了myApp.log文件<br>
查看内容</p>
<pre><code class="language-shell">file 2021-07-09 12:53:33,940 TRACE [main] com.example.App [App.java:22] Hello trace!
file 2021-07-09 12:53:33,942 DEBUG [main] com.example.App [App.java:23] Hello debug!
file 2021-07-09 12:53:33,943 INFO [main] com.example.App [App.java:24] Hello info!
file 2021-07-09 12:53:33,943 WARN [main] com.example.App [App.java:25] Hello warn!
file 2021-07-09 12:53:33,948 ERROR [main] com.example.App [App.java:26] Hello error!
</code></pre>
<p>正如我们定义<code>appender</code>一样。</p>
<h2 id="参考资料">参考资料</h2>
<p>[1] <a href="https://baike.baidu.com/item/%E6%97%A5%E5%BF%97/2769135?fr=aladdin">百度百科 日志</a><br>
[2] <a href="https://www.liaoxuefeng.com/wiki/1252599548343744">廖雪峰的官方网站 Java教程</a><br>
[3] <a href="http://www.slf4j.org/">SLF4J官网</a><br>
[4] <a href="https://logback.qos.ch/">Logback官网</a><br>
[5] <a href="https://juejin.cn/post/6844903949598736391#heading-5">Java日志框架：SLF4J详解</a><br>
[6] <a href="https://www.jianshu.com/p/ec3bd614dcb0">SLF4J日志级别以及使用场景</a><br>
[7] <a href="https://www.runoob.com/xml/xml-tutorial.html">XML 教程</a></p>

              </div>
              <div class="toc-container">
                <ul class="markdownIt-TOC">
<li>
<ul>
<li><a href="#%E6%97%A5%E5%BF%97%E6%A6%82%E5%BF%B5">日志概念</a>
<ul>
<li><a href="#%E6%97%A5%E5%BF%97%E6%98%AF%E4%BB%80%E4%B9%88">日志是什么</a></li>
<li><a href="#%E6%97%A5%E5%BF%97%E6%9C%89%E4%BB%80%E4%B9%88%E4%BC%98%E7%82%B9">日志有什么优点</a></li>
</ul>
</li>
<li><a href="#java%E4%B8%AD%E7%9A%84%E6%97%A5%E5%BF%97">Java中的日志</a>
<ul>
<li><a href="#%E5%B8%B8%E8%A7%81%E7%9A%84%E6%97%A5%E5%BF%97%E5%B7%A5%E5%85%B7">常见的日志工具</a></li>
<li><a href="#%E6%88%91%E7%9A%84%E9%80%89%E6%8B%A9">我的选择</a></li>
<li><a href="#%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C">准备工作</a>
<ul>
<li><a href="#%E6%96%B0%E5%BB%BA%E7%A4%BA%E4%BE%8B%E5%B7%A5%E7%A8%8B">新建示例工程</a></li>
</ul>
</li>
<li><a href="#%E9%85%8D%E7%BD%AE%E5%B7%A5%E7%A8%8B%E4%BE%9D%E8%B5%96">配置工程依赖</a></li>
</ul>
</li>
<li><a href="#%E4%B8%8A%E6%89%8B">上手</a>
<ul>
<li><a href="#%E6%9C%80%E5%9F%BA%E6%9C%AC%E7%9A%84%E7%94%A8%E6%B3%95">最基本的用法</a></li>
<li><a href="#slf4j%E6%97%A5%E5%BF%97%E7%AD%89%E7%BA%A7">SLF4J日志等级</a></li>
<li><a href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6logback">配置文件(Logback)</a>
<ul>
<li><a href="#groovy">Groovy</a></li>
<li><a href="#xml">XML</a>
<ul>
<li><a href="#%E5%90%8D%E8%AF%8D%E8%A7%A3%E9%87%8A">名词解释</a></li>
<li><a href="#conversion-word">Conversion Word</a></li>
<li><a href="#format-modifiers">Format modifiers</a></li>
</ul>
</li>
<li><a href="#%E8%BE%93%E5%87%BA%E6%97%A5%E5%BF%97%E5%88%B0%E6%96%87%E4%BB%B6">输出日志到文件</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">参考资料</a></li>
</ul>
</li>
</ul>

              </div>
            </div>
          </article>
        </div>

        
          <div class="next-post">
            <div class="next">下一篇</div>
            <a href="https://lzw-723.github.io/post/vue-chu-ti-yan/">
              <h3 class="post-title">
                Vue初体验
              </h3>
            </a>
          </div>
        

        
          
            <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>

<div id="gitalk-container"></div>

<script>

  var gitalk = new Gitalk({
    clientID: '399620a9c9195b7466cf',
    clientSecret: '00893bb4d0569d3ccd4b718ab36d35a4a4be9f6d',
    repo: 'lzw-723.github.io',
    owner: 'lzw-723',
    admin: ['lzw-723'],
    id: (location.pathname).substring(0, 49),      // Ensure uniqueness and length less than 50
    distractionFreeMode: false  // Facebook-like distraction free mode
  })

  gitalk.render('gitalk-container')

</script>

          

          
        

        <div class="site-footer">
  Powered by <a href="https://github.com/getgridea/gridea" target="_blank">Gridea</a>
  <a class="rss" href="https://lzw-723.github.io/atom.xml" target="_blank">
    <i class="ri-rss-line"></i> RSS
  </a>
</div>

      </div>
    </div>

    <script>
      hljs.initHighlightingOnLoad()

      let mainNavLinks = document.querySelectorAll(".markdownIt-TOC a");

      // This should probably be throttled.
      // Especially because it triggers during smooth scrolling.
      // https://lodash.com/docs/4.17.10#throttle
      // You could do like...
      // window.addEventListener("scroll", () => {
      //    _.throttle(doThatStuff, 100);
      // });
      // Only not doing it here to keep this Pen dependency-free.

      window.addEventListener("scroll", event => {
        let fromTop = window.scrollY;

        mainNavLinks.forEach((link, index) => {
          let section = document.getElementById(decodeURI(link.hash).substring(1));
          let nextSection = null
          if (mainNavLinks[index + 1]) {
            nextSection = document.getElementById(decodeURI(mainNavLinks[index + 1].hash).substring(1));
          }
          if (section.offsetTop <= fromTop) {
            if (nextSection) {
              if (nextSection.offsetTop > fromTop) {
                link.classList.add("current");
              } else {
                link.classList.remove("current");    
              }
            } else {
              link.classList.add("current");
            }
          } else {
            link.classList.remove("current");
          }
        });
      });

    </script>
  </body>
</html>
